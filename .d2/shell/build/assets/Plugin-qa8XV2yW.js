import{P as n,R as a,c as r,_ as y,r as m,a as Q,t as O,s as W,m as Qe,b as ue,i as _,C as ve,u as ie,d as Ye,j as c,B as k,N as K,F as je,I as he,e as _e,f as ae,M as Je,g as Xe,h as et,k as tt}from"./plugin-CblFezKD.js";const rt=t=>typeof t>"u"||t===null||t==="",Ce=(t,e,s)=>(l,o,i)=>{const p=l[o];return s?new Error(`Property \`${o}\` on component \`${i}\` is using the \`requiredIf\` prop-validator combined with \`.isRequired\`. This is an invalid combination.`):typeof t!="function"?new Error("The `condition` argument passed to the `requiredIf` prop-validator was not a function."):typeof e!="function"?new Error("The `propType` argument passed to the `requiredIf` prop-validator was not a function."):t(l)&&rt(p)?new Error(`Invalid prop \`${o}\` supplied to \`${i}\`, this prop is conditionally required but has value \`${p}\`. The condition that made this prop required is: \`${t.toString()}\`.`):(n.checkPropTypes({[o]:e},l,"prop",i),null)};function pe(t,e){const s=Ce(t,e,!1);return s.isRequired=Ce(t,e,!0),s}const T=["svg.jsx-4069423049{display:block;pointer-events:none;}",`svg.jsx-4069423049 .border.jsx-4069423049{fill:${r.grey800};}`,`svg.jsx-4069423049 .background.jsx-4069423049,svg.jsx-4069423049 .indeterminate.jsx-4069423049,svg.jsx-4069423049 .checkmark.jsx-4069423049{fill:${r.white};}`,`svg.checked.jsx-4069423049 .background.jsx-4069423049,svg.indeterminate.jsx-4069423049 .background.jsx-4069423049{fill:${r.teal500};}`,`svg.valid.jsx-4069423049 .background.jsx-4069423049{fill:${r.blue600};}`,`svg.warning.jsx-4069423049 .background.jsx-4069423049{fill:${r.yellow700};}`,`svg.error.jsx-4069423049 .background.jsx-4069423049{fill:${r.red500};}`,`svg.checked.jsx-4069423049 .border.jsx-4069423049,svg.indeterminate.jsx-4069423049 .border.jsx-4069423049{fill:${r.teal900};}`,"svg.jsx-4069423049:not(.checked) .checkmark.jsx-4069423049,svg.jsx-4069423049:not(.indeterminate) .indeterminate.jsx-4069423049{fill:none;}",`svg.jsx-4069423049:not(.checked):not(.indeterminate) .background.jsx-4069423049{fill:${r.white};}`];T.__hash="4069423049";function Te(t){let{className:e}=t;return a.createElement("svg",{viewBox:"0 0 18 18",xmlns:"http://www.w3.org/2000/svg",className:`jsx-${T.__hash} `+y.dynamic([["2753140462",[r.grey300,r.grey400,r.blue600,r.blue700,r.yellow700,r.yellow800,r.red500,r.red700]]])+" "+(e||"")},a.createElement("rect",{x:"0",y:"0",width:"18",height:"18",rx:"3",className:`jsx-${T.__hash} `+y.dynamic([["2753140462",[r.grey300,r.grey400,r.blue600,r.blue700,r.yellow700,r.yellow800,r.red500,r.red700]]])+" background"}),a.createElement("path",{d:"M15,0 C16.6568542,0 18,1.34314575 18,3 L18,15 C18,16.6568542 16.6568542,18 15,18 L3,18 C1.34314575,18 0,16.6568542 0,15 L0,3 C0,1.34314575 1.34314575,0 3,0 L15,0 Z M15,1 L3,1 C1.9456382,1 1.08183488,1.81587779 1.00548574,2.85073766 L1,3 L1,15 C1,16.0543618 1.81587779,16.9181651 2.85073766,16.9945143 L3,17 L15,17 C16.0543618,17 16.9181651,16.1841222 16.9945143,15.1492623 L17,15 L17,3 C17,1.9456382 16.1841222,1.08183488 15.1492623,1.00548574 L15,1 Z",className:`jsx-${T.__hash} `+y.dynamic([["2753140462",[r.grey300,r.grey400,r.blue600,r.blue700,r.yellow700,r.yellow800,r.red500,r.red700]]])+" border"}),a.createElement("path",{d:"M4.74451387,8.02852516 C4.39595738,8.11985643 4.12375034,8.39235188 4.03251575,8.74127768 C3.94128115,9.09020348 4.04521722,9.46125864 4.30437605,9.71182782 L7.29823844,12.7078028 C7.68753993,13.0973991 8.31859767,13.0973991 8.70789916,12.7078028 L13.695624,6.71585285 C13.9547828,6.46528367 14.0587189,6.09422851 13.9674843,5.74530271 C13.8762497,5.39637691 13.6040426,5.12388146 13.2554861,5.0325502 C12.9069296,4.94121893 12.5362672,5.04526513 12.2859632,5.30469855 L8.0030688,10.5910713 L5.71403676,8.30067351 C5.46373279,8.0412401 5.09307036,7.9371939 4.74451387,8.02852516 Z",className:`jsx-${T.__hash} `+y.dynamic([["2753140462",[r.grey300,r.grey400,r.blue600,r.blue700,r.yellow700,r.yellow800,r.red500,r.red700]]])+" checkmark"}),a.createElement("rect",{x:"4",y:"8",width:"10",height:"2",rx:"1",className:`jsx-${T.__hash} `+y.dynamic([["2753140462",[r.grey300,r.grey400,r.blue600,r.blue700,r.yellow700,r.yellow800,r.red500,r.red700]]])+" indeterminate"}),a.createElement(y,{id:T.__hash},T),a.createElement(y,{id:"2753140462",dynamic:[r.grey300,r.grey400,r.blue600,r.blue700,r.yellow700,r.yellow800,r.red500,r.red700]},["svg.__jsx-style-dynamic-selector{width:18px;height:18px;}",`svg.disabled.__jsx-style-dynamic-selector .background.__jsx-style-dynamic-selector{fill:${r.grey300};}`,`svg.disabled.__jsx-style-dynamic-selector .border.__jsx-style-dynamic-selector{fill:${r.grey400};}`,`svg.valid.__jsx-style-dynamic-selector .border.__jsx-style-dynamic-selector{fill:${r.blue600};}`,`svg.valid.checked.__jsx-style-dynamic-selector .border.__jsx-style-dynamic-selector,svg.valid.indeterminate.__jsx-style-dynamic-selector .border.__jsx-style-dynamic-selector{fill:${r.blue700};}`,`svg.warning.__jsx-style-dynamic-selector .border.__jsx-style-dynamic-selector{fill:${r.yellow700};}`,`svg.warning.checked.__jsx-style-dynamic-selector .border.__jsx-style-dynamic-selector,svg.warning.indeterminate.__jsx-style-dynamic-selector .border.__jsx-style-dynamic-selector{fill:${r.yellow800};}`,`svg.error.__jsx-style-dynamic-selector .border.__jsx-style-dynamic-selector{fill:${r.red500};}`,`svg.error.checked.__jsx-style-dynamic-selector .border.__jsx-style-dynamic-selector,svg.error.indeterminate.__jsx-style-dynamic-selector .border.__jsx-style-dynamic-selector{fill:${r.red700};}`]))}Te.propTypes={className:n.string};function Ne(t){let{className:e}=t;return a.createElement("svg",{viewBox:"0 0 14 14",xmlns:"http://www.w3.org/2000/svg",className:`jsx-${T.__hash} `+y.dynamic([["86695588",[r.grey400,r.grey400,r.grey500,r.blue600,r.blue800,r.yellow700,r.yellow800,r.red500,r.red800]]])+" "+(e||"")},a.createElement("rect",{x:"0",y:"0",width:"14",height:"14",rx:"2",className:`jsx-${T.__hash} `+y.dynamic([["86695588",[r.grey400,r.grey400,r.grey500,r.blue600,r.blue800,r.yellow700,r.yellow800,r.red500,r.red800]]])+" background"}),a.createElement("path",{d:"M2,0 L12,0 C13.1045695,0 14,0.8954305 14,2 L14,12 C14,13.1045695 13.1045695,14 12,14 L2,14 C0.8954305,14 0,13.1045695 0,12 L0,2 C0,0.8954305 0.8954305,0 2,0 Z M2,1 C1.44771525,1 1,1.44771525 1,2 L1,12 C1,12.5522847 1.44771525,13 2,13 L12,13 C12.5522847,13 13,12.5522847 13,12 L13,2 C13,1.44771525 12.5522847,1 12,1 L2,1 Z",className:`jsx-${T.__hash} `+y.dynamic([["86695588",[r.grey400,r.grey400,r.grey500,r.blue600,r.blue800,r.yellow700,r.yellow800,r.red500,r.red800]]])+" border"}),a.createElement("path",{d:"M10.3520005,3.30015877 L5.54268293,8.03252726 L3.64634146,6.16652726 L2.28668615,7.5044281 L5.54310367,10.7010587 L11.7145993,4.628307 L10.3520005,3.30015877 Z M5.54268293,9.43547274 L5.61193184,9.36733181 L5.54226219,9.29894127 L5.47309681,9.367 L5.54268293,9.43547274 Z M10.6496329,4.41023392 L10.6495057,4.35652297 L10.5648412,4.35672356 L10.2854007,4.631693 L10.3553166,4.69984123 L10.6496329,4.41023392 Z M3.42891348,7.22439304 L3.35030905,7.22439304 L3.35034135,7.27820863 L3.64634146,7.56947274 L3.71331385,7.5035719 L3.42891348,7.22439304 Z",className:`jsx-${T.__hash} `+y.dynamic([["86695588",[r.grey400,r.grey400,r.grey500,r.blue600,r.blue800,r.yellow700,r.yellow800,r.red500,r.red800]]])+" checkmark"}),a.createElement("rect",{x:"3",y:"6",width:"8",height:"2",className:`jsx-${T.__hash} `+y.dynamic([["86695588",[r.grey400,r.grey400,r.grey500,r.blue600,r.blue800,r.yellow700,r.yellow800,r.red500,r.red800]]])+" indeterminate"}),a.createElement(y,{id:T.__hash},T),a.createElement(y,{id:"86695588",dynamic:[r.grey400,r.grey400,r.grey500,r.blue600,r.blue800,r.yellow700,r.yellow800,r.red500,r.red800]},["svg.__jsx-style-dynamic-selector{width:14px;height:14px;}",`svg.disabled.__jsx-style-dynamic-selector .background.__jsx-style-dynamic-selector{fill:${r.grey400};}`,`svg.disabled.__jsx-style-dynamic-selector .border.__jsx-style-dynamic-selector{fill:${r.grey400};}`,`svg.disabled.checked.__jsx-style-dynamic-selector .border.__jsx-style-dynamic-selector,svg.disabled.indeterminate.__jsx-style-dynamic-selector .border.__jsx-style-dynamic-selector{fill:${r.grey500};}`,`svg.valid.__jsx-style-dynamic-selector .border.__jsx-style-dynamic-selector{fill:${r.blue600};}`,`svg.valid.checked.__jsx-style-dynamic-selector .border.__jsx-style-dynamic-selector,svg.valid.indeterminate.__jsx-style-dynamic-selector .border.__jsx-style-dynamic-selector{fill:${r.blue800};}`,`svg.warning.__jsx-style-dynamic-selector .border.__jsx-style-dynamic-selector{fill:${r.yellow700};}`,`svg.warning.checked.__jsx-style-dynamic-selector .border.__jsx-style-dynamic-selector,svg.warning.indeterminate.__jsx-style-dynamic-selector .border.__jsx-style-dynamic-selector{fill:${r.yellow800};}`,`svg.error.__jsx-style-dynamic-selector .border.__jsx-style-dynamic-selector{fill:${r.red500};}`,`svg.error.checked.__jsx-style-dynamic-selector .border.__jsx-style-dynamic-selector,svg.error.indeterminate.__jsx-style-dynamic-selector .border.__jsx-style-dynamic-selector{fill:${r.red800};}`]))}Ne.propTypes={className:n.string};function se(t,e,s){return(e=nt(e))in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}function nt(t){var e=st(t,"string");return typeof e=="symbol"?e:e+""}function st(t,e){if(typeof t!="object"||!t)return t;var s=t[Symbol.toPrimitive];if(s!==void 0){var l=s.call(t,e);if(typeof l!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ye extends m.Component{constructor(){super(...arguments),se(this,"ref",m.createRef()),se(this,"handleChange",e=>{this.props.onChange&&this.props.onChange(this.createHandlerPayload(),e)}),se(this,"handleBlur",e=>{this.props.onBlur&&this.props.onBlur(this.createHandlerPayload(),e)}),se(this,"handleFocus",e=>{this.props.onFocus&&this.props.onFocus(this.createHandlerPayload(),e)}),se(this,"handleKeyDown",e=>{this.props.onKeyDown&&this.props.onKeyDown(this.createHandlerPayload(),e)})}componentDidMount(){this.props.initialFocus&&this.ref.current.focus(),this.setIndeterminate(this.props.indeterminate)}componentDidUpdate(e){e.indeterminate!==this.props.indeterminate&&this.setIndeterminate(this.props.indeterminate)}setIndeterminate(e){this.ref.current.indeterminate=e}createHandlerPayload(){return{value:this.props.value,name:this.props.name,checked:!this.props.checked}}render(){const{checked:e=!1,indeterminate:s=!1,className:l,disabled:o,error:i,label:p,name:u,tabIndex:d,valid:g,value:h,warning:b,dense:E,dataTest:N="dhis2-uicore-checkbox"}=this.props,j=Q({checked:e,indeterminate:s,disabled:o,valid:g,error:i,warning:b});return a.createElement("label",{"data-test":N,className:y.dynamic([["1252368010",[r.grey900,O.disabled,W.dp4,O.focus]]])+" "+(Q(l,{disabled:o,dense:E})||"")},a.createElement("input",{type:"checkbox",ref:this.ref,name:u,value:h,checked:e,disabled:o,tabIndex:d,onChange:this.handleChange,onFocus:this.handleFocus,onKeyDown:this.handleKeyDown,onBlur:this.handleBlur,className:y.dynamic([["1252368010",[r.grey900,O.disabled,W.dp4,O.focus]]])}),a.createElement("div",{className:y.dynamic([["1252368010",[r.grey900,O.disabled,W.dp4,O.focus]]])+" "+(Q("icon",{dense:E})||"")},E?a.createElement(Ne,{className:j}):a.createElement(Te,{className:j})),p,a.createElement(y,{id:"1252368010",dynamic:[r.grey900,O.disabled,W.dp4,O.focus]},[`label.__jsx-style-dynamic-selector{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;position:relative;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:start;-webkit-justify-content:flex-start;-ms-flex-pack:start;justify-content:flex-start;cursor:pointer;color:${r.grey900};font-size:14px;line-height:19px;}`,"label.dense.__jsx-style-dynamic-selector{font-size:14px;line-height:16px;}",`label.disabled.__jsx-style-dynamic-selector{cursor:not-allowed;color:${O.disabled};}`,"input.__jsx-style-dynamic-selector{opacity:0;position:absolute;height:18px;width:18px;inset-inline-start:3px;}","label.dense.__jsx-style-dynamic-selector input.__jsx-style-dynamic-selector{height:14px;width:14px;}",`.icon.__jsx-style-dynamic-selector{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;margin-inline-end:${W.dp4};border:2px solid transparent;padding:1px;border-radius:5px;}`,"label.dense.__jsx-style-dynamic-selector .icon.__jsx-style-dynamic-selector{margin-inline-end:3px;border-radius:4px;}",`input.__jsx-style-dynamic-selector:focus+.icon.__jsx-style-dynamic-selector{outline:3px solid ${O.focus};outline-offset:-3px;}`]))}}se(ye,"defaultProps",{checked:!1,indeterminate:!1,dataTest:"dhis2-uicore-checkbox"});const Se=Qe(["checked","indeterminate"],n.bool);ye.propTypes={checked:Se,className:n.string,dataTest:n.string,dense:n.bool,disabled:n.bool,error:ue,indeterminate:Se,initialFocus:n.bool,label:n.node,name:n.string,tabIndex:n.string,valid:ue,value:n.string,warning:ue,onBlur:n.func,onChange:n.func,onFocus:n.func,onKeyDown:n.func};const Oe=t=>{let{children:e,open:s,dataTest:l}=t;return a.createElement("div",{"data-test":l,className:"jsx-3677374542 "+(Q({open:s})||"")},e,a.createElement(y,{id:"3677374542"},["div.jsx-3677374542{height:0;overflow:hidden;-webkit-box-flex:1;-webkit-flex-grow:1;-ms-flex-positive:1;flex-grow:1;}",".open.jsx-3677374542{height:auto;}"]))};Oe.propTypes={children:n.node,dataTest:n.string,open:n.bool};const at=()=>a.createElement("div",{className:"jsx-2503342345"},a.createElement(y,{id:"2503342345"},["div.jsx-2503342345{width:24px;}"])),lt=()=>a.createElement("div",{className:"nodeArrow"},a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",className:"jsx-4098137027"},a.createElement("path",{d:"M15.7041 10.3329L12.1495 14.3318C12.0699 14.4213 11.9301 14.4213 11.8505 14.3318L8.29589 10.3329C8.18124 10.2039 8.2728 10 8.44537 10H15.5546C15.7272 10 15.8188 10.2039 15.7041 10.3329Z",className:"jsx-4098137027"}),a.createElement(y,{id:"4098137027"},["svg.jsx-4098137027{fill:inherit;height:24px;width:24px;vertical-align:middle;pointer-events:none;}"]))),Le=t=>{let{open:e,onOpen:s,onClose:l,dataTest:o}=t;const i=e?l:s;return a.createElement("div",{"data-test":o,onClick:p=>i&&i({open:!e},p),className:y.dynamic([["375729792",[r.grey400,r.grey900,r.grey100]]])+" "+(Q({open:e})||"")},a.createElement("span",{className:y.dynamic([["375729792",[r.grey400,r.grey900,r.grey100]]])},a.createElement(lt,null)),a.createElement(y,{id:"375729792",dynamic:[r.grey400,r.grey900,r.grey100]},["div.__jsx-style-dynamic-selector{width:24px;position:relative;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;}",`div.__jsx-style-dynamic-selector:after{background:${r.grey400};height:calc(100% - 24px);inset-inline-start:12px;position:absolute;top:15px;width:1px;z-index:1;}`,".open.__jsx-style-dynamic-selector:after{content:'';}",`span.__jsx-style-dynamic-selector{display:block;position:relative;z-index:2;fill:${r.grey900};}`,"div.__jsx-style-dynamic-selector .nodeArrow{vertical-align:top;-webkit-transform:rotate(-90deg);-ms-transform:rotate(-90deg);transform:rotate(-90deg);-webkit-transition:-webkit-transform 0.1s ease-out;-webkit-transition:transform 0.1s ease-out;transition:transform 0.1s ease-out;}","div.__jsx-style-dynamic-selector .nodeArrow:dir(rtl){-webkit-transform:rotate(90deg);-ms-transform:rotate(90deg);transform:rotate(90deg);}",".open.__jsx-style-dynamic-selector .nodeArrow{-webkit-transform:rotate(0);-ms-transform:rotate(0);transform:rotate(0);}",".open.__jsx-style-dynamic-selector .nodeArrow:dir(rtl){-webkit-transform:rotate(0);-ms-transform:rotate(0);transform:rotate(0);}",`div.__jsx-style-dynamic-selector:hover{cursor:pointer;border-radius:3px;background:${r.grey100};}`,"div.__jsx-style-dynamic-selector:hover.__jsx-style-dynamic-selector:after{background:#bcc8d4;}"]))};Le.propTypes={dataTest:n.string.isRequired,open:n.bool,onClose:n.func,onOpen:n.func};const Ae=t=>{let{open:e,className:s,component:l,children:o,icon:i,onOpen:p,onClose:u,dataTest:d="dhis2-uicore-node"}=t;const g=!!a.Children.toArray(o).filter(E=>E).length,h=!i&&g,b=!i&&!g;return a.createElement("div",{"data-test":d,className:"jsx-1433072554 "+(Q("node",s)||"")},i&&a.createElement("div",{"data-test":`${d}-icon`,className:"jsx-1433072554"},i),h&&a.createElement(Le,{open:e,onOpen:p,onClose:u,dataTest:`${d}-toggle`}),b&&a.createElement(at,null),a.createElement("div",{"data-test":`${d}-content`,className:"jsx-1433072554"},a.createElement("div",{"data-test":`${d}-label`,className:"jsx-1433072554"},l),a.createElement(Oe,{open:e,dataTest:`${d}-leaves`},o)),a.createElement(y,{id:"1433072554"},[".node.jsx-1433072554{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}"]))};Ae.propTypes={children:n.node,className:n.string,component:n.element,dataTest:n.string,icon:n.node,open:n.bool,onClose:n.func,onOpen:n.func};const $e=(t,e)=>t.some(l=>e===l?!0:l.startsWith(`${e}/`)),ot=(t,e)=>t.replace(new RegExp(`^.*(/${e})`),"$1"),it=t=>[...t].sort((e,s)=>e.displayName.localeCompare(s.displayName)),dt={"No children match filter":"","Could not load children":"تعذر تحميل الأبناء","Error: {{ ERRORMESSAGE }}":"خطأ: {{ ERRORMESSAGE }}"},ct={"No children match filter":"Filtru neodpovídají žádné podřízené","Could not load children":"Nelze načíst podřazené","Error: {{ ERRORMESSAGE }}":"Chyba: {{ ERRORMESSAGE }}"},ut={"No children match filter":"No children match filter","Could not load children":"Could not load children","Error: {{ ERRORMESSAGE }}":"Error: {{ ERRORMESSAGE }}"},ht={"No children match filter":"Sin filtros de coincidencia en los elementos inferiores","Could not load children":"No se pudo cargar los elementos inferiores","Error: {{ ERRORMESSAGE }}":"Error: {{ ERRORMESSAGE }}"},pt={"No children match filter":"Ningún descendiente coincide con el filtro","Could not load children":"No se han podido cargar los descendientes","Error: {{ ERRORMESSAGE }}":"Error: {{ ERRORMESSAGE }}"},gt={"No children match filter":"Aucun enfant ne correspond au filtre","Could not load children":"Impossible de charger les enfants","Error: {{ ERRORMESSAGE }}":"Erreur : {{ ERRORMESSAGE }}"},mt={"No children match filter":"ບໍ່ພົບເດັກນ້ອຍທີ່ກົງກັບຕົວກອງ","Could not load children":"ບໍ່ສາມາດໂຫຼດເດັກນ້ອຍໄດ້","Error: {{ ERRORMESSAGE }}":"ຂໍ້ຜິດພາດ {{ ERRORMESSAGE }}"},yt={"No children match filter":"Ingen underenheter matcher filter","Could not load children":"Kunne ikke laste underordnede enheter","Error: {{ ERRORMESSAGE }}":"Feil: {{ ERRORMESSAGE }}"},ft={"No children match filter":"Er komen geen kinderen overeen met het filter","Could not load children":"Kan kinderen niet laden","Error: {{ ERRORMESSAGE }}":"Fout: {{ ERRORMESSAGE }}"},xt={"No children match filter":"Nenhum filho corresponde ao filtro","Could not load children":"Não foi possível carregar os filhos","Error: {{ ERRORMESSAGE }}":"Erro: {{ ERRORMESSAGE }}"},Et={"No children match filter":"Нет дочерних единиц, соответствующих фильтру","Could not load children":"¨Не удалось загрузить дочерние единицы","Error: {{ ERRORMESSAGE }}":"Ошибка: {{ ERRORMESSAGE }}"},bt={"No children match filter":"Немає дочірніх об'єктів, які відповідають фільтру","Could not load children":"Не вдалося завантажити дочірні об'єкти","Error: {{ ERRORMESSAGE }}":"Помилка: {{ ERRORMESSAGE }}"},Rt={"No children match filter":"","Could not load children":"Bolalar yuklanmadi","Error: {{ ERRORMESSAGE }}":""},wt={"No children match filter":"Фильтрга мос бўлган авлод мавжуд эмас","Could not load children":"Болалар юкланмади","Error: {{ ERRORMESSAGE }}":"Хатолик: {{ ERRORMESSAGE }}"},jt={"No children match filter":"","Could not load children":"Bolalar yuklanmadi","Error: {{ ERRORMESSAGE }}":""},_t={"No children match filter":"Không có đơn vị con phù hợp với bộ lọc","Could not load children":"Không thể tải đơn vị con","Error: {{ ERRORMESSAGE }}":"Lỗi: {{ ERRORMESSAGE }}"},Ct={"No children match filter":"没有下属匹配过滤器","Could not load children":"无法加载下属","Error: {{ ERRORMESSAGE }}":"错误：{{ ERRORMESSAGE }}"},St={"No children match filter":"","Could not load children":"无法加载下属","Error: {{ ERRORMESSAGE }}":""},S="default";_.addResources("ar",S,dt);_.addResources("cs",S,ct);_.addResources("en",S,ut);_.addResources("es",S,ht);_.addResources("es_419",S,pt);_.addResources("fr",S,gt);_.addResources("lo",S,mt);_.addResources("nb",S,yt);_.addResources("nl",S,ft);_.addResources("pt",S,xt);_.addResources("ru",S,Et);_.addResources("uk",S,bt);_.addResources("uz_Latn",S,Rt);_.addResources("uz_UZ_Cyrl",S,wt);_.addResources("uz_UZ_Latn",S,jt);_.addResources("vi",S,_t);_.addResources("zh",S,Ct);_.addResources("zh_CN",S,St);const kt="[a-zA-Z][a-zA-Z0-9]{10}",vt=new RegExp(`(/${kt})+`),L=(t,e,s,l,o)=>{if(!vt.test(t[e]))return new Error(`Invalid org unit path \`${t[e]}\` supplied to \`${s}.${o}\``)},Me=t=>{let{children:e,dataTest:s}=t;return a.createElement("span",{"data-test":`${s}-error`,className:y.dynamic([["3198585030",[r.grey800,W.dp4,O.error]]])},e,a.createElement(y,{id:"3198585030",dynamic:[r.grey800,W.dp4,O.error]},[`span.__jsx-style-dynamic-selector{font-size:14px;color:${r.grey800};margin:${W.dp4};color:${O.error};}`]))};Me.propTypes={children:n.any.isRequired,dataTest:n.string.isRequired};const Tt=(t,e)=>e.some(s=>{const l=!s.match(new RegExp(`${t}$`)),o=s.match(new RegExp(t));return l&&o}),fe=t=>{let{checked:e,children:s,onChange:l,loading:o}=t;return a.createElement("span",{onClick:i=>{l({checked:!e},i)},className:y.dynamic([["321503310",[r.grey900,r.teal700]]])+" "+(Q({checked:e,loading:o})||"")},s,a.createElement(y,{id:"321503310",dynamic:[r.grey900,r.teal700]},[`span.__jsx-style-dynamic-selector{background:transparent;border-radius:3px;color:${r.grey900};cursor:pointer;display:inline-block;font-size:14px;line-height:24px;padding:0 5px;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;white-space:nowrap;}`,`.checked.__jsx-style-dynamic-selector{background:${r.teal700};color:white;}`,".loading.__jsx-style-dynamic-selector{cursor:auto;}"]))};fe.propTypes={children:n.any.isRequired,checked:n.bool,loading:n.bool,onChange:n.func};const Ue=t=>{let{children:e,loading:s,onToggleOpen:l}=t;return a.createElement(fe,{checked:!1,loading:s,onChange:l},e)};Ue.propTypes={children:n.any.isRequired,onToggleOpen:n.func.isRequired,loading:n.bool};const qe=t=>{let{dataTest:e}=t;return a.createElement("svg",{height:"18px",version:"1.1",viewBox:"0 0 18 18",width:"18px","data-test":`${e}-iconempty`,className:"jsx-3201893673"},a.createElement("g",{fill:"none",fillRule:"evenodd",id:"icon/empty",stroke:"none",strokeWidth:"1",className:"jsx-3201893673"}),a.createElement(y,{id:"3201893673"},["svg.jsx-3201893673{display:block;margin:3px 0;}"]))};qe.propTypes={dataTest:n.string.isRequired};const De=t=>{let{dataTest:e}=t;return a.createElement("svg",{width:"18px",height:"18px",viewBox:"0 0 18 18",version:"1.1","data-test":`${e}-iconfolderclosed`,className:"jsx-3201893673"},a.createElement("g",{id:"icon/folder/closed",stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd",className:"jsx-3201893673"},a.createElement("path",{d:"M2,3.5 C1.17157288,3.5 0.5,4.17157288 0.5,5 L0.5,13 C0.5,13.8284271 1.17157288,14.5 2,14.5 L12,14.5 C12.8284271,14.5 13.5,13.8284271 13.5,13 L13.5,7 C13.5,6.17157288 12.8284271,5.5 12,5.5 L6.69098301,5.5 L5.82917961,3.7763932 C5.7444836,3.60700119 5.57135204,3.5 5.38196601,3.5 L2,3.5 Z",id:"Path-2",stroke:"#6C7787",fill:"#D5DDE5",className:"jsx-3201893673"})),a.createElement(y,{id:"3201893673"},["svg.jsx-3201893673{display:block;margin:3px 0;}"]))};De.propTypes={dataTest:n.string.isRequired};const Ie=t=>{let{dataTest:e}=t;return a.createElement("svg",{width:"18px",height:"18px",viewBox:"0 0 18 18",version:"1.1","data-test":`${e}-iconfolderopen`,className:"jsx-2091325045"},a.createElement("g",{id:"icon/folder/open",stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd",className:"jsx-2091325045"},a.createElement("g",{id:"Group",transform:"translate(0.000000, 3.000000)",stroke:"#6C7787",className:"jsx-2091325045"},a.createElement("path",{d:"M2,0.5 C1.17157288,0.5 0.5,1.17157288 0.5,2 L0.5,10 C0.5,10.8284271 1.17157288,11.5 2,11.5 L12,11.5 C12.8284271,11.5 13.5,10.8284271 13.5,10 L13.5,4 C13.5,3.17157288 12.8284271,2.5 12,2.5 L6.69098301,2.5 L5.82917961,0.776393202 C5.7444836,0.607001188 5.57135204,0.5 5.38196601,0.5 L2,0.5 Z",id:"Path-2",fill:"#A0ADBA",className:"jsx-2091325045"}),a.createElement("path",{d:"M1.53632259,10.7093809 C1.47575089,10.7941813 1.44318932,10.8957885 1.44318932,11 C1.44318932,11.2761424 1.66704695,11.5 1.94318932,11.5 L12.4853821,11.5 C12.6468577,11.5 12.7983931,11.4220172 12.8922488,11.2906191 L16.4636774,6.2906191 C16.5242491,6.20581872 16.5568107,6.10421149 16.5568107,6 C16.5568107,5.72385763 16.3329531,5.5 16.0568107,5.5 L5.5146179,5.5 C5.35314234,5.5 5.20160692,5.57798284 5.10775116,5.7093809 L1.53632259,10.7093809 Z",id:"Path-3",fill:"#FBFCFD",className:"jsx-2091325045"}))),a.createElement(y,{id:"2091325045"},["svg.jsx-2091325045{margin:3px 0;display:block;}"]))};Ie.propTypes={dataTest:n.string.isRequired};const Pe=t=>{let{dataTest:e}=t;return a.createElement("svg",{height:"18px",version:"1.1",viewBox:"0 0 18 18",width:"18px","data-test":`${e}-iconsingle`,className:"jsx-3201893673"},a.createElement("g",{fill:"none",fillRule:"evenodd",id:"icon/single",stroke:"none",strokeWidth:"1",className:"jsx-3201893673"},a.createElement("rect",{fill:"#A0ADBA",height:"4",id:"Rectangle",rx:"1",width:"4",x:"7",y:"7",className:"jsx-3201893673"})),a.createElement(y,{id:"3201893673"},["svg.jsx-3201893673{display:block;margin:3px 0;}"]))};Pe.propTypes={dataTest:n.string.isRequired};const Fe=t=>{let{loading:e,hasChildren:s,open:l,dataTest:o}=t;return e?a.createElement(qe,{dataTest:o}):s?l?a.createElement(Ie,{dataTest:o}):a.createElement(De,{dataTest:o}):a.createElement(Pe,{dataTest:o})};Fe.propTypes={dataTest:n.string.isRequired,hasChildren:n.bool,loading:n.bool,open:n.bool};const Ge=t=>{let{checked:e,dataTest:s,hasChildren:l,indeterminate:o,children:i,loading:p,name:u,open:d,value:g,onChange:h}=t;const b=a.createElement(Fe,{loading:p,open:d,hasChildren:l,dataTest:s}),E=a.createElement(a.Fragment,null,a.createElement("span",{className:"jsx-1000763175"},b),i,a.createElement(y,{id:"1000763175"},["span.jsx-1000763175{display:inline-block;margin-inline-end:4px;}"]));return a.createElement(a.Fragment,null,a.createElement(ye,{dense:!0,checked:e,name:u,value:g,label:E,indeterminate:o,onChange:h}))};Ge.propTypes={checked:n.bool.isRequired,children:n.any.isRequired,dataTest:n.string.isRequired,hasChildren:n.bool.isRequired,indeterminate:n.bool.isRequired,loading:n.bool.isRequired,name:n.string.isRequired,open:n.bool.isRequired,value:n.string.isRequired,onChange:n.func.isRequired};const oe=t=>{let{highlighted:e,children:s}=t;return a.createElement("div",{className:y.dynamic([["1387769986",[r.teal200]]])+" "+(Q({highlighted:e})||"")},a.createElement("span",{className:y.dynamic([["1387769986",[r.teal200]]])},s),a.createElement(y,{id:"1387769986",dynamic:[r.teal200]},["div.__jsx-style-dynamic-selector{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}","span.__jsx-style-dynamic-selector{display:block;}",`.highlighted.__jsx-style-dynamic-selector{background:${r.teal200};padding-inline-end:4px;}`]))};oe.propTypes={children:n.node,highlighted:n.bool};const Nt=t=>{let{selected:e,path:s,checked:l,singleSelection:o}=t;const i=e.indexOf(s);if(l&&i!==-1)return e;if(o&&l)return[s];if(l)return[...e,s];if(i===-1)return e;if(o)return[];if(e.indexOf(s)===0)return e.slice(1);const p=e.slice(0,i),u=e.slice(i+1);return[...p,...u]},ze=t=>{let{checked:e,children:s,dataTest:l,disableSelection:o,fullPath:i,hasChildren:p,hasSelectedDescendants:u,highlighted:d,loading:g,node:h,onChange:b,onToggleOpen:E,open:N,rootId:j,selected:G,singleSelection:A}=t;const U=(q,D)=>{let{checked:x}=q;const v=Nt({path:i,selected:G,checked:x,singleSelection:A}),C={...h,path:i,checked:x,selected:v};b(C,D)};return o?a.createElement(oe,{highlighted:d},a.createElement(Ue,{loading:g,onToggleOpen:E},s)):A?a.createElement(oe,{highlighted:d},a.createElement(fe,{checked:e,onChange:U,loading:g},s)):a.createElement(oe,{highlighted:d},a.createElement(Ge,{dataTest:l,checked:e,name:"org-unit",value:h.id,loading:g,indeterminate:!e&&u,onChange:U,open:N,hasChildren:p},s))};ze.propTypes={children:n.any.isRequired,dataTest:n.string.isRequired,fullPath:n.string.isRequired,hasChildren:n.bool.isRequired,loading:n.bool.isRequired,node:n.shape({displayName:n.string.isRequired,id:n.string.isRequired,children:n.number,path:n.string}).isRequired,open:n.bool.isRequired,rootId:n.string.isRequired,onChange:n.func.isRequired,onToggleOpen:n.func.isRequired,checked:n.bool,disableSelection:n.bool,hasSelectedDescendants:n.bool,highlighted:n.bool,selected:n.arrayOf(L),singleSelection:n.bool};const ke={styles:a.createElement(y,{id:"358163430"},[".extrasmall.jsx-358163430{display:block;margin:3px 0;}"]),className:"jsx-358163430"},Be=()=>a.createElement("div",{className:"jsx-2503342345"},a.createElement(ve,{extrasmall:!0,className:ke.className}),a.createElement("style",null,ke.styles),a.createElement(y,{id:"2503342345"},["div.jsx-2503342345{width:24px;}"])),Ot={orgUnit:{resource:"organisationUnits",id:t=>{let{id:e}=t;return e},params:{fields:"children[id,path,displayName]"}}},Lt=t=>{let{node:e,suppressAlphabeticalSorting:s,onComplete:l}=t;const o=m.useRef(!1),{called:i,loading:p,error:u,data:d}=ie(Ot,{variables:{id:e.id}}),g=m.useMemo(()=>{if(!d)return;if(!e.children)return[];const{orgUnit:h}=d;return s?h.children:it(h.children)},[d,s]);return m.useEffect(()=>{l&&g&&!o.current&&(l({...e,children:g}),o.current=!0)},[l,g,o]),{called:i,loading:p,error:u||null,data:g}},At=t=>{let{orgChildren:e,filter:s,node:l}=t;return s!=null&&s.length?e.filter(o=>$e(s,`${l.path}/${o.id}`)):e},Ze=t=>{let{node:e,autoExpandLoadingError:s,dataTest:l,disableSelection:o,expanded:i,filter:p,highlighted:u,isUserDataViewFallback:d,onChange:g,onChildrenLoaded:h,onCollapse:b,onExpand:E,parentPath:N,renderNodeLabel:j,rootId:G,selected:A,singleSelection:U,suppressAlphabeticalSorting:q,OrganisationUnitNode:D}=t;const x=Lt({node:e,suppressAlphabeticalSorting:q,onComplete:h}),v=x.called&&!x.loading&&!x.error,C=v?At({orgChildren:x.data,filter:p,node:e}):[];return a.createElement(a.Fragment,null,x.loading&&a.createElement(Be,null),x.error&&`Error: ${x.error}`,v&&!C.length&&_.t("No children match filter"),!!C.length&&C.map($=>{const P=`${N}/${$.id}`;return a.createElement(D,{autoExpandLoadingError:s,dataTest:l,disableSelection:o,displayName:$.displayName,expanded:i,filter:p,highlighted:u,id:$.id,isUserDataViewFallback:d,key:P,onChange:g,onChildrenLoaded:h,onCollapse:b,onExpand:E,path:P,renderNodeLabel:j,rootId:G,selected:A,singleSelection:U,suppressAlphabeticalSorting:q})}))};Ze.propTypes={OrganisationUnitNode:n.func.isRequired,dataTest:n.string.isRequired,node:n.object.isRequired,parentPath:n.string.isRequired,renderNodeLabel:n.func.isRequired,rootId:n.string.isRequired,onChange:n.func.isRequired,autoExpandLoadingError:n.bool,disableSelection:n.bool,expanded:n.arrayOf(L),filter:n.arrayOf(L),highlighted:n.arrayOf(L),isUserDataViewFallback:n.bool,selected:n.arrayOf(L),singleSelection:n.bool,suppressAlphabeticalSorting:n.bool,onChildrenLoaded:n.func,onCollapse:n.func,onExpand:n.func};const $t=t=>{let{path:e,expanded:s,onExpand:l,onCollapse:o,errorMessage:i,autoExpandLoadingError:p}=t;const u=p&&!!i,[d,g]=m.useState(!!i);m.useEffect(()=>{u&&!d&&(l({path:e}),g(!0))},[u,d]);const h=u&&!d||!!s.includes(e);return{open:h,onToggleOpen:()=>h?o({path:e}):l({path:e}),openedOnceDueToError:d}},Mt={orgUnit:{resource:"organisationUnits",id:t=>{let{id:e}=t;return e},params:t=>{let{isUserDataViewFallback:e}=t;return{isUserDataViewFallback:e,fields:["path","children::size"]}}}},Ut=(t,e)=>{let{displayName:s,isUserDataViewFallback:l}=e;if(!s)throw new Error('"displayName" is required');const o={id:t,isUserDataViewFallback:l},{loading:i,error:p,data:u={}}=ie(Mt,{variables:o});return{loading:i,error:p||null,data:{id:t,displayName:s,...u.orgUnit}}},xe=t=>{let{autoExpandLoadingError:e,dataTest:s,disableSelection:l,displayName:o,expanded:i,highlighted:p,id:u,isUserDataViewFallback:d,path:g,renderNodeLabel:h,rootId:b,selected:E,singleSelection:N,filter:j,suppressAlphabeticalSorting:G,onChange:A,onChildrenLoaded:U,onCollapse:q,onExpand:D}=t;const x=Ut(u,{isUserDataViewFallback:d,displayName:o}),v=ot(g,b),C={displayName:o,id:u,...x.data||{},path:v},$=!!C.children&&C.children>0,P=Tt(v,E),Y=p.includes(g),{open:z,onToggleOpen:B}=$t({autoExpandLoadingError:e,errorMessage:x.error&&x.error.toString(),path:v,expanded:i,onExpand:D,onCollapse:q}),Z=!!E.find(V=>V.match(new RegExp(`${v}$`))),F=h({disableSelection:l,hasChildren:$,hasSelectedDescendants:P,loading:x.loading,error:x.error,selected:E,open:z,path:g,singleSelection:N,node:C,label:o,checked:Z,highlighted:Y}),re=a.createElement(ze,{node:C,fullPath:g,open:z,loading:x.loading,checked:Z,rootId:b,onChange:A,dataTest:`${s}-label`,selected:E,hasChildren:$,highlighted:Y,onToggleOpen:B,disableSelection:l,singleSelection:N,hasSelectedDescendants:P},F),J=$&&!z&&!x.error,X=$&&z&&!x.error;return a.createElement(Ae,{dataTest:`${s}-node`,open:z,onOpen:B,onClose:B,component:re,icon:x.loading&&a.createElement(Be,null)},x.error&&a.createElement(Me,{dataTest:s},_.t("Could not load children")),J&&a.createElement("span",{"data-test":`${s}-placeholder`}),X&&a.createElement(Ze,{OrganisationUnitNode:xe,node:C,autoExpandLoadingError:e,dataTest:s,disableSelection:l,expanded:i,filter:j,highlighted:p,isUserDataViewFallback:d,onChange:A,onChildrenLoaded:U,onCollapse:q,onExpand:D,parentPath:g,renderNodeLabel:h,rootId:b,selected:E,singleSelection:N,suppressAlphabeticalSorting:G}))};xe.propTypes={dataTest:n.string.isRequired,id:n.string.isRequired,renderNodeLabel:n.func.isRequired,rootId:n.string.isRequired,onChange:n.func.isRequired,autoExpandLoadingError:n.bool,disableSelection:n.bool,displayName:n.string,expanded:n.arrayOf(L),filter:n.arrayOf(L),highlighted:n.arrayOf(L),isUserDataViewFallback:n.bool,path:L,selected:n.arrayOf(L),singleSelection:n.bool,suppressAlphabeticalSorting:n.bool,onChildrenLoaded:n.func,onCollapse:n.func,onExpand:n.func};const qt=t=>{let{label:e}=t;return e},Dt=(t,e)=>t!=null&&t.length?e.filter(s=>$e(t,`/${s}`)):e,Ve=t=>{let{dataTest:e="dhis2-uiwidgets-orgunittree-error",error:s}=t;return a.createElement("div",{"data-test":e},_.t("Error: {{ ERRORMESSAGE }}",{ERRORMESSAGE:s,nsSeparator:">"}))};Ve.propTypes={error:n.string.isRequired,dataTest:n.string};const He=t=>{let{dataTest:e="dhis2-uiwidgets-orgunittree-loading"}=t;return a.createElement("div",{"data-test":e,className:"jsx-814846266"},a.createElement(ve,{small:!0}),a.createElement(y,{id:"814846266"},["div.jsx-814846266{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;}"]))};He.propTypes={dataTest:n.string};const It=t=>Array.from(new Set(t)),Pt=t=>{const e=t.replace(/^\//,"").split("/"),s=e.map((l,o)=>`/${e.slice(0,o+1).join("/")}`);return It(s)},Ft=t=>t.reduce((e,s)=>{const l=Pt(s);return[...e,...l]},[]),Gt=t=>{let{expanded:e,setExpanded:s,onExpand:l,onCollapse:o}=t;return{handleExpand:u=>{let{path:d,...g}=u;e.includes(d)||(s([...e,d]),l&&l({path:d,...g}))},handleCollapse:u=>{let{path:d,...g}=u;const h=e.indexOf(d);if(h!==-1){const b=h===0?e.slice(1):[...e.slice(0,h),...e.slice(h+1)];s(b),o&&o({path:d,...g})}}}},zt=t=>{let{initiallyExpanded:e,onExpand:s,onCollapse:l,expandedControlled:o,handleExpandControlled:i,handleCollapseControlled:p}=t;const u=!!o,d=u?[]:Ft(e),[g,h]=m.useState(d);if(u)return{expanded:o,handleExpand:i,handleCollapse:p};const{handleExpand:b,handleCollapse:E}=Gt({expanded:g,setExpanded:h,onExpand:s,onCollapse:l});return{expanded:g,handleExpand:b,handleCollapse:E}},Bt=t=>{const[e,s]=m.useState(0);return m.useEffect(()=>{const l=e+1;t===!0&&s(l)},[t]),e},Zt=t=>{const s=Object.entries(t).map(l=>{let[o,i]=l;const p=i.displayName||"";return[o,{...i,displayName:p}]});return Object.fromEntries(s)},Vt=t=>t.reduce((e,s)=>({...e,[s]:{id:s,resource:"organisationUnits",params:l=>{let{isUserDataViewFallback:o}=l;return{isUserDataViewFallback:o,fields:["displayName","path","id"]}}}}),{}),Ht=function(t){let{isUserDataViewFallback:e}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const s=m.useMemo(()=>Vt(t),[t]),o=ie(s,{variables:{isUserDataViewFallback:e}}),{called:i,loading:p,error:u,data:d,refetch:g}=o,h=m.useMemo(()=>d&&Zt(d),[d]);return{called:i,loading:p,error:u||null,data:h||null,refetch:g}},le=[],Ke=t=>{let{onChange:e,roots:s,autoExpandLoadingError:l,dataTest:o="dhis2-uiwidgets-orgunittree",disableSelection:i,forceReload:p,highlighted:u=le,isUserDataViewFallback:d,initiallyExpanded:g=le,filter:h=le,renderNodeLabel:b=qt,selected:E=le,singleSelection:N,suppressAlphabeticalSorting:j,expanded:G,handleExpand:A,handleCollapse:U,onExpand:q,onCollapse:D,onChildrenLoaded:x}=t;const v=Dt(h,Array.isArray(s)?s:[s]),C=Bt(p),[$,P]=m.useState(C),{called:Y,loading:z,error:B,data:Z,refetch:F}=Ht(v,{isUserDataViewFallback:d,suppressAlphabeticalSorting:j}),{expanded:re,handleExpand:J,handleCollapse:X}=zt({initiallyExpanded:g,onExpand:q,onCollapse:D,expandedControlled:G,handleExpandControlled:A,handleCollapseControlled:U});m.useEffect(()=>(F&&C>0&&C!==$&&(F(),P(C)),()=>console.warn("@TODO: Why does this component unmount after a force reload?")),[C,$,F]);const V=!Y||z;return a.createElement("div",{"data-test":o},V&&a.createElement(He,null),B&&a.createElement(Ve,{error:B}),!B&&!V&&v.map(H=>{const ne=Z[H];return a.createElement(xe,{key:ne.path,rootId:H,autoExpandLoadingError:l,dataTest:o,disableSelection:i,displayName:ne.displayName,expanded:re,highlighted:u,id:H,isUserDataViewFallback:d,filter:h,path:ne.path,renderNodeLabel:b,selected:E,singleSelection:N,suppressAlphabeticalSorting:j,onChange:e,onChildrenLoaded:x,onCollapse:X,onExpand:J})}))};Ke.propTypes={roots:n.oneOfType([n.string,n.arrayOf(n.string)]).isRequired,onChange:n.func.isRequired,autoExpandLoadingError:n.bool,dataTest:n.string,disableSelection:n.bool,expanded:pe(t=>!!t.handleExpand||!!t.handleCollapse,n.arrayOf(n.string)),filter:n.arrayOf(L),forceReload:n.bool,handleCollapse:pe(t=>!!t.expanded||!!t.handleExpand,n.func),handleExpand:pe(t=>!!t.expanded||!!t.handleCollapse,n.func),highlighted:n.arrayOf(L),initiallyExpanded:n.arrayOf(L),isUserDataViewFallback:n.bool,renderNodeLabel:n.func,selected:n.arrayOf(L),singleSelection:n.bool,suppressAlphabeticalSorting:n.bool,onChildrenLoaded:n.func,onCollapse:n.func,onExpand:n.func};const Kt={roots:{resource:"organisationUnits",params:{userOnly:!0,fields:"id,displayName,path"}}},Wt="trackedEntityType,orgUnit,enrollments[enrollment,program,orgUnit,status,occurredAt,enrolledAt,events[event,program,programStage,orgUnit,status,occurredAt,scheduledAt]]",Qt=!1,ge=2,Yt=300,me=t=>{var l,o,i;if(!t||typeof t!="object")return"Transfer failed.";const e=t.message,s=(i=(o=(l=t.details)==null?void 0:l.response)==null?void 0:o.data)==null?void 0:i.message;return s||e||"Transfer failed."},Jt=(t,e)=>{const[s,l]=m.useState(t);return m.useEffect(()=>{const o=window.setTimeout(()=>{l(t)},e);return()=>{window.clearTimeout(o)}},[t,e]),s},Xt=(t,e)=>{var o,i;const s=(i=(o=t==null?void 0:t.details)==null?void 0:o.response)==null?void 0:i.status;if(!s||s<400||s>=500)return!1;const l=me(t).toLowerCase();return l.includes("unknown parameter")||l.includes("parameter")&&l.includes(e.toLowerCase())};class er extends a.Component{constructor(e){super(e),this.state={hasError:!1}}static getDerivedStateFromError(){return{hasError:!0}}componentDidCatch(){this.props.onError("Failed to render org unit tree. Use manual entry instead.")}render(){return this.state.hasError?null:this.props.children}}const tr=({initialTeiId:t="",programId:e="",currentOrgUnitId:s="",onClose:l,mode:o="modal"})=>{const i=Ye(),{data:p}=ie(Kt),[u]=m.useState(t),[d,g]=m.useState([]),[h,b]=m.useState(null),[E,N]=m.useState(null),[j,G]=m.useState(s),[A,U]=m.useState(null),[q,D]=m.useState(null),[x,v]=m.useState(null),[C,$]=m.useState(null),[P,Y]=m.useState(!1),[z,B]=m.useState(""),[Z,F]=m.useState([]),[re,J]=m.useState(null),[X,V]=m.useState(!1),H=Jt(z,Yt),ne=m.useMemo(()=>{var R;const f=(R=p==null?void 0:p.roots)==null?void 0:R.organisationUnits;return Array.isArray(f)?f.filter(w=>w&&typeof w.id=="string").map(w=>w.id):[]},[p]);m.useEffect(()=>{s&&G(s)},[s]),m.useEffect(()=>{if(!u||j)return;let f=!0;return(async()=>{try{const{tei:w}=await i.query({tei:{resource:`tracker/trackedEntities/${u}`,params:{fields:"orgUnit"}}});if(!f)return;const I=w;I.orgUnit&&G(I.orgUnit)}catch{if(!f)return}})(),()=>{f=!1}},[u,j,i]),m.useEffect(()=>{if(!j){U(null);return}let f=!0;return(async()=>{try{const{ou:w}=await i.query({ou:{resource:`organisationUnits/${j}`,params:{fields:"id,displayName"}}});if(!f)return;U(w.displayName||null)}catch{if(!f)return;U(null)}})(),()=>{f=!1}},[j,i]),m.useEffect(()=>{let f=!0;return(async()=>{if(!h){N(null);return}try{const{ou:w}=await i.query({ou:{resource:`organisationUnits/${h}`,params:{fields:"id,displayName,path"}}});if(!f)return;N(w)}catch(w){if(!f)return;D(me(w))}})(),()=>{f=!1}},[h,i]),m.useEffect(()=>{if(o!=="inline")return;window.setTimeout(()=>{const R=document.querySelector('[data-test="tei-transfer-search"] input');R==null||R.focus()},0);const f=R=>{R.key==="Escape"&&(R.preventDefault(),l())};return window.addEventListener("keydown",f),()=>{window.removeEventListener("keydown",f)}},[o,l]),m.useEffect(()=>{const f=H.trim();if(f.length<ge){F([]),J(null),V(!1);return}let R=!0;return V(!0),J(null),(async()=>{try{const{orgUnits:I}=await i.query({orgUnits:{resource:"organisationUnits",params:{filter:`displayName:ilike:${f}`,fields:"id,displayName",paging:!0,pageSize:15}}});if(!R)return;const ce=I==null?void 0:I.organisationUnits;Array.isArray(ce)?F(ce):F([])}catch{if(!R)return;J("Failed to search org units."),F([])}finally{R&&V(!1)}})(),()=>{R=!1}},[H,i]);const We=m.useMemo(()=>A||j||"Unknown org unit",[j,A]),ee=(h==null?void 0:h.trim())??"",de=!!(j&&ee&&j===ee),Ee=!!(u&&e&&ee&&!de&&!P),be=async()=>{var f,R;if(!(!u||!e||!ee||de)){Y(!0),v(null),D(null);try{const w=async M=>i.mutate({resource:"tracker/ownership/transfer",type:"update",params:{[M]:u,program:e,ou:ee},data:{trackedEntity:u,program:e,orgUnit:ee}});try{await w("trackedEntity")}catch(M){if(Xt(M,"trackedEntity"))await w("trackedEntityInstance");else throw M}const{tei:I}=await i.query({tei:{resource:`tracker/trackedEntities/${u}`,params:{fields:Wt}}}),te=(f=I.enrollments)==null?void 0:f.find(M=>M.program===e);Qt&&(te!=null&&te.enrollment);const we=((R=te==null?void 0:te.events)==null?void 0:R.map(M=>({event:M.event,program:M.program,programStage:M.programStage,enrollment:te.enrollment,orgUnit:ee,status:M.status,occurredAt:M.occurredAt,scheduledAt:M.scheduledAt})))??[];we.length>0&&await i.mutate({resource:"tracker",type:"create",data:{events:we},params:{async:!1,importStrategy:"UPDATE"}}),v("Transfer completed.")}catch(w){const I=me(w);D(I)}finally{Y(!1)}}},Re=c.jsxs(k,{display:"flex",flexDirection:"column",gap:"16px",children:[!u&&c.jsx(K,{warning:!0,title:"Missing TEI context",children:"No tracked entity was provided by Capture. Open this widget from a TEI enrollment."}),!e&&c.jsx(K,{warning:!0,title:"Missing program context",children:"No program was provided by Capture. Open this widget from a program enrollment."}),de&&c.jsx(K,{warning:!0,title:"Destination org unit unchanged",children:"Choose a different org unit to transfer this case."}),c.jsxs(k,{style:{fontSize:14},children:["From ",c.jsx("strong",{children:We})," to"]}),c.jsxs(je,{label:"Destination Org Unit",children:[c.jsxs(k,{display:"flex",flexDirection:"column",gap:"8px",children:[c.jsx(he,{value:z,onChange:({value:f})=>B(f),placeholder:"Search org units",dataTest:"tei-transfer-search"}),re&&c.jsx(K,{warning:!0,title:"Search unavailable",children:re}),X&&c.jsx(k,{style:{fontSize:12,color:"#556070"},children:"Searching..."}),H.trim().length>=ge&&!X&&Z.length>0&&c.jsx(k,{style:{border:"1px solid #e8edf2",borderRadius:6,background:"#fff",maxHeight:160,overflowY:"auto"},children:Z.map(f=>c.jsx("button",{type:"button",onClick:()=>{b(f.id),g([f.id]),B(f.displayName),F([])},style:{width:"100%",padding:"8px",textAlign:"left",background:"transparent",border:"none",borderBottom:"1px solid #f0f3f6",cursor:"pointer"},children:f.displayName},f.id))}),H.trim().length>=ge&&!X&&Z.length===0&&c.jsx(k,{style:{fontSize:12,color:"#556070"},children:"No matching org units."})]}),C?c.jsxs(c.Fragment,{children:[c.jsx(K,{warning:!0,title:"Org unit tree unavailable",children:C}),c.jsx(k,{marginTop:"12px",children:c.jsx(he,{value:h??"",onChange:({value:f})=>b(f),placeholder:"Enter destination org unit UID"})})]}):ne.length===0?c.jsx(K,{warning:!0,title:"Org unit tree unavailable",children:"No root org units were loaded. Check your user org unit access."}):c.jsx(k,{padding:"8px",overflow:"auto",style:{background:"#fff",borderRadius:6,border:"1px solid #e8edf2",minHeight:420,height:480,flexShrink:0},children:c.jsx(er,{onError:f=>$(f),children:c.jsx(Ke,{roots:ne,selected:d,singleSelection:!0,onChange:({selected:f,id:R})=>{const w=f.filter(Boolean).slice(-1);g(w),b(R)}})})})]}),E&&c.jsx(je,{label:"Selected Org Unit",children:c.jsx(he,{value:`${E.displayName} (${E.id})`,readOnly:!0})}),q&&c.jsx(K,{error:!0,title:"Transfer failed",children:q}),x&&c.jsx(K,{title:"Success",children:x})]});return o==="inline"?c.jsxs(k,{padding:"16px",width:"100%",maxWidth:"100%",border:"1px solid #e8edf2",background:"#fff",boxShadow:"0 1px 3px rgba(0, 0, 0, 0.12)",dataTest:"tei-transfer-panel",style:{minHeight:720,height:720,display:"flex",flexDirection:"column",overflow:"hidden"},children:[c.jsx(k,{marginBottom:"12px",style:{textAlign:"center"},children:c.jsx("strong",{children:"Transfer case"})}),c.jsx(k,{style:{flex:"1 1 auto",minHeight:0},children:c.jsx(k,{style:{height:560,overflow:"auto"},children:Re})}),c.jsx(k,{marginTop:"16px",children:c.jsxs(_e,{end:!0,children:[c.jsx(ae,{secondary:!0,onClick:l,children:"Close"}),c.jsx(ae,{primary:!0,onClick:be,disabled:!Ee,loading:P,children:"Transfer"})]})})]}):c.jsxs(Je,{position:"middle",large:!0,fluid:!0,onClose:l,dataTest:"tei-transfer-modal",children:[c.jsx(Xe,{children:"Transfer TEI"}),c.jsx(et,{children:Re}),c.jsx(tt,{children:c.jsxs(_e,{end:!0,children:[c.jsx(ae,{secondary:!0,onClick:l,children:"Close"}),c.jsx(ae,{primary:!0,onClick:be,disabled:!Ee,loading:P,children:"Transfer"})]})})]})},rr=t=>{var e;return t.trackedEntityId||t.teiId||((e=t.trackedEntity)==null?void 0:e.id)||""},sr=t=>{var u,d,g;const e=m.useMemo(()=>rr(t),[t]),[s,l]=m.useState(!1),o=()=>{l(!1),window.setTimeout(()=>{const h=document.querySelector('[data-test="tei-transfer-trigger"] button');h==null||h.focus()},0)},i=t.programId||((u=t.program)==null?void 0:u.id)||((d=t.enrollment)==null?void 0:d.program)||"",p=t.orgUnitId||((g=t.enrollment)==null?void 0:g.orgUnit)||"";return c.jsxs(k,{style:{fontFamily:O.fonts},children:[!s&&c.jsx(k,{className:"tei-transfer-trigger-container",children:c.jsx(ae,{primary:!0,onClick:()=>l(!0),dataTest:"tei-transfer-trigger",children:"TRANSFER CASE"})}),s&&c.jsx(k,{marginTop:"12px",children:c.jsx(tr,{initialTeiId:e,programId:i,currentOrgUnitId:p,onClose:o,mode:"inline"})})]})};export{sr as default};
//# sourceMappingURL=Plugin-qa8XV2yW.js.map
